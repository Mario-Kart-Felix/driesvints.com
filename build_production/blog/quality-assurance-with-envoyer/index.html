<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <!-- Site info -->
    <title>Quality Assurance with Envoyer | Dries Vints</title>

    
            <meta property="article:published_time" content="2015-08-25" />
    
    <!-- Stylsheets -->
    <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,600,600i,700,700i;Ubuntu+Mono" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/build/css/main.css?id=da0adb7d3b8cf6146889">

    <!-- Google Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-18478762-2']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</head>
<body class="bg-grey-lightest font-sans text-lg text-grey-darker leading-normal antialiased border-t-8 border-theme-blue h-full">
    
    <div class="text-xl max-w-lg m-auto px-4 py-8 md:py-12">
            <div class="text-center italic text-sm mb-8">
        <a href="/">
            <img src="https://www.gravatar.com/avatar/e8321183acdf47a9ce838afd13a964b5?s=100" width="50" class="rounded-full enlarge">
        </a>
        <p class="font-bold mb-0">Dries Vints</p>
        <p class="md:text-xs">
            <a href="/">Home</a> |
            <a href="/blog">Blog</a> |
            <a href="https://twitter.com/driesvints">Twitter</a>
        </p>
    </div>

    <div class="text-center mb-12">
        <h1 class="mb-4">Quality Assurance with Envoyer</h1>
        <p class="italic text-sm">
            Published on August 25, 2015
        </p>
    </div>

    <div class="post max-w-md m-auto">
        <p>This is one of the tutorials I did for my Laracon EU talk.</p>
<p>Most of you probably know about <a href="https://envoyer.io">Envoyer</a>'s ability to deploy branches. This doesn't makes much sense for your production server but it could help a lot when developing features.</p>
<p>For example, at <a href="https://beatswitch.com">BeatSwitch</a> we always let a QA engineer manually test out features to make sure everything's ok before we merge and deploy it. Of course, your automated tests should do the bulk of this but a user's eye often sees things that tests don't. That's why a manually check is still important.</p>
<p>How this process could go is that you have a separate QA server which is provisioned by <a href="https://forge.laravel.com">Forge</a> and setup Envoyer to deploy code to that server. Envoyer's ability to switch branches will help us greatly.</p>
<p>You set up the server and Envoyer like you'd normally do. Perhaps on some other <code>env</code> variables than your production instance. After that it's very important that you add one deployment hook before a new release is cloned. You'll need to reset your database because it could be that one feature branch holds different migrations than your other feature branch which is currently live on the server. So running those migrations all the way back will allow you to run all of the new migrations.</p>
<p>You can do that with this hook:</p>
<pre><code class="language-bash">cd /home/forge/default/current
php artisan migrate:reset --force</code></pre>
<p>After that you'll only need to add another hook to run your migrations for the new branch.</p>
<pre><code>cd {{release}}
php artisan migrate --force --seed</code></pre>
<p>Notice that we seed the database with dummy data. This is handy for the QA to have some data for him to get started.</p>
<p>With this setup you can freely swith branches with envoyer and let your team test out a new feature on the QA server.</p>
                    <p class="text-center text-sm mt-12">
                                    <a href="/blog/laravel-io-the-road-ahead">&laquo; Laravel.IO - The Road Ahead</a>
                
                                    |
                
                                    <a href="/blog/continuous-delivery-with-forge-and-envoyer">Continuous Delivery with Forge and Envoyer &raquo;</a>
                            </p>
            </div>
    </div>

    <script src="/assets/build/js/main.js?id=0e7dc19ff43e9f3f44e0"></script>
</body>
</html>
